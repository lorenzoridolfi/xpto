# WorkflowCriticAgent: Automated Critique and Action Planning for Multi-Agent Workflows

## Overview

`WorkflowCriticAgent` is a class designed to analyze the execution trace of a multi-agent workflow, optionally incorporate human feedback, and generate a critique and action plan for improving the workflow. This agent is especially useful in systems where transparency, continuous improvement, and human-in-the-loop feedback are important.

## Purpose

- **Automated Workflow Review:** Analyze the sequence of actions, agent interactions, and outcomes in a workflow.
- **Human Feedback Integration:** Combine human observations or suggestions with trace data for richer analysis.
- **Actionable Recommendations:** Generate a critique and propose concrete steps to improve the workflow, agent design, or orchestration.

## How It Works

1. **Trace File Analysis:**
    - Loads the trace file (JSON) generated by the workflow (e.g., from `AutoTracingGroupChat`).
    - Optionally enriches each action with agent metadata (description, system message) for context-aware analysis.
2. **Human Feedback:**
    - Accepts a string or structured feedback from a human user.
3. **Critique Generation:**
    - Uses rules, heuristics, or an LLM to analyze the trace and feedback.
    - Identifies issues, bottlenecks, or improvement opportunities.
4. **Action Plan:**
    - Proposes a step-by-step plan to address identified issues and enhance the workflow.

## Why Include Agent Descriptions and System Messages?

- **Contextual Analysis:** Knowing each agent's intended role and behavior allows for more meaningful critique (e.g., "The SummarizerAgent did not summarize as expected").
- **Trace Enrichment:** Including this metadata in the trace enables both automated and human reviewers to understand the rationale behind each action.
- **Better Recommendations:** Action plans can suggest changes to agent prompts, descriptions, or system messages for targeted improvements.

## Example Usage

```python
critic = WorkflowCriticAgent(
    trace_path="update_manifest_trace.json",
    agent_metadata={
        "FileReaderAgent": {
            "description": "Reads file content for manifest generation.",
            "system_message": "Reads file content for manifest generation."
        },
        "SummarizerAgent": {
            "description": "Summarizes file content using LLM.",
            "system_message": "Summarizes file content using LLM."
        },
        # ... other agents ...
    }
)

human_feedback = "The summarizer was too verbose and the validator missed a schema error."
report = critic.critique(human_feedback)
print(report["critique"])
print(report["action_plan"])
```

## Possible Extensions

- **LLM Integration:** Use a language model to generate more nuanced critiques and action plans based on the trace and feedback.
- **Automated Trace Enrichment:** Automatically add agent descriptions/system messages to the trace during workflow execution.
- **Visualization:** Generate visual summaries or graphs of agent interactions and workflow bottlenecks.
- **Continuous Improvement Loop:** Feed action plans back into the workflow for iterative refinement.

## Summary

`WorkflowCriticAgent` bridges the gap between raw workflow traces and actionable improvement, making multi-agent systems more transparent, auditable, and continuously improvableâ€”especially when combined with rich agent metadata and human feedback. 